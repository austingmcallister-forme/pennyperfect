(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[890],{2898:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var r=s(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,t)=>{let s=(0,r.forwardRef)(({color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:c,...d},o)=>(0,r.createElement)("svg",{ref:o,...a,width:n,height:n,stroke:s,strokeWidth:l?24*Number(i)/Number(n):i,className:`lucide lucide-${toKebabCase(e)}`,...d},[...t.map(([e,t])=>(0,r.createElement)(e,t)),...(Array.isArray(c)?c:[c])||[]]));return s.displayName=`${e}`,s}},3067:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(2898);let a=(0,r.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7917:function(e,t,s){Promise.resolve().then(s.bind(s,5394))},5394:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ExperimentDetailPage}});var r=s(7437),a=s(2265),n=s(4033),i=s(1396),l=s.n(i),c=s(3067),d=s(2898);let o=(0,d.Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),m=(0,d.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),x=(0,d.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),h=(0,d.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),u=(0,d.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),p=(0,d.Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);function ExperimentDetailPage(e){let{params:t}=e;(0,n.useRouter)();let[s,i]=(0,a.useState)(null),[d,f]=(0,a.useState)(!0),[y,g]=(0,a.useState)(null);(0,a.useEffect)(()=>{fetchExperiment()},[t.id]);let fetchExperiment=async()=>{try{let e=await fetch("/api/experiments/".concat(t.id));if(e.ok){let t=await e.json();i(t)}}catch(e){console.error("Error fetching experiment:",e)}finally{f(!1)}},handlePromote=async()=>{g("promote");try{let e=await fetch("/api/experiments/".concat(t.id,"/promote"),{method:"POST"});e.ok&&await fetchExperiment()}catch(e){console.error("Error promoting experiment:",e)}finally{g(null)}},handleRevert=async()=>{g("revert");try{let e=await fetch("/api/experiments/".concat(t.id,"/revert"),{method:"POST"});e.ok&&await fetchExperiment()}catch(e){console.error("Error reverting experiment:",e)}finally{g(null)}},handleStatusChange=async e=>{g("status");try{let s=await fetch("/api/experiments/".concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})});s.ok&&await fetchExperiment()}catch(e){console.error("Error updating experiment status:",e)}finally{g(null)}},calculateRPV=(e,t)=>{let s="bigint"==typeof e?Number(e):e;return t>0?(s/t).toFixed(2):"0.00"},calculateCVR=(e,t)=>t>0?(e/t*100).toFixed(2):"0.00";return d?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading experiment..."})]})}):s?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)(l(),{href:"/experiments",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 mb-4",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Back to Experiments"]}),(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:s.band.name}),(0,r.jsxs)("p",{className:"mt-2 text-gray-600",children:["Started ",new Date(s.startedAt).toLocaleDateString(),s.endedAt&&(0,r.jsxs)("span",{children:[" â€¢ Ended ",new Date(s.endedAt).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"running":return"bg-green-100 text-green-800";case"promoted":return"bg-blue-100 text-blue-800";case"reverted":return"bg-red-100 text-red-800";case"paused":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(s.status)),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),"running"===s.status&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>handleStatusChange("paused"),disabled:"status"===y,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:[(0,r.jsx)(o,{className:"h-4 w-4 mr-1"}),"Pause"]}),(0,r.jsxs)("button",{onClick:handlePromote,disabled:"promote"===y,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[(0,r.jsx)(m,{className:"h-4 w-4 mr-1"}),"Promote"]}),(0,r.jsx)("button",{onClick:handleRevert,disabled:"revert"===y,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",children:"Revert"})]}),"paused"===s.status&&(0,r.jsxs)("button",{onClick:()=>handleStatusChange("running"),disabled:"status"===y,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 disabled:opacity-50",children:[(0,r.jsx)(x,{className:"h-4 w-4 mr-1"}),"Resume"]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuration"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(h,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[s.cadenceHours,"h cadence"]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Switch interval"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[100*s.revertThresholdRpv,"% threshold"]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"RPV improvement"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[s.minSessions," min sessions"]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Required data"})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(p,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[s.minCycles," min cycles"]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Before decision"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Period Performance"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.periods.map((e,t)=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 ".concat(e.endedAt?"bg-gray-50":"bg-blue-50 border-blue-200"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[".",e.ending," ending"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Period ",t+1]}),!e.endedAt&&(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Active"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Sessions:"}),(0,r.jsx)("span",{className:"font-medium",children:e.sessions.toLocaleString()})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Orders:"}),(0,r.jsx)("span",{className:"font-medium",children:e.orders.toLocaleString()})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Revenue:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",(Number(e.revenueCents)/100).toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"CVR:"}),(0,r.jsxs)("span",{className:"font-medium",children:[calculateCVR(e.orders,e.sessions),"%"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"RPV:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",calculateRPV(Number(e.revenueCents),e.sessions)]})]})]}),(0,r.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[new Date(e.startedAt).toLocaleDateString()," -"," ",e.endedAt?new Date(e.endedAt).toLocaleDateString():"Ongoing"]})})]},e.id))})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Experiment Not Found"}),(0,r.jsxs)(l(),{href:"/experiments",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Back to Experiments"]})]})})}},622:function(e,t,s){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=s(2265),a=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,s){var r,c={},d=null,o=null;for(r in void 0!==s&&(d=""+s),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(o=t.ref),t)n.call(t,r)&&!l.hasOwnProperty(r)&&(c[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===c[r]&&(c[r]=t[r]);return{$$typeof:a,type:e,key:d,ref:o,props:c,_owner:i.current}}t.jsx=q,t.jsxs=q},7437:function(e,t,s){"use strict";e.exports=s(622)},1396:function(e,t,s){e.exports=s(8326)},4033:function(e,t,s){e.exports=s(94)}},function(e){e.O(0,[326,971,472,744],function(){return e(e.s=7917)}),_N_E=e.O()}]);